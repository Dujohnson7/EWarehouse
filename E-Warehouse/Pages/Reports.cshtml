@page
@model E_Warehouse.Pages.ReportsModel
@{
} 

<div class="card">
            <div class="card-body">
              <h5 class="card-title fw-semibold mb-4">Reports</h5>
              
              <div class="row">
                <div class="col-md-6 col-lg-3">
                  <div class="card">
                    <div class="card-body">
                      <div class="d-flex align-items-center">
                        <div class="flex-shrink-0">
                          <div class="bg-primary-subtle rounded p-3">
                            <iconify-icon icon="solar:box-line-duotone" class="fs-3 text-primary"></iconify-icon>
                          </div>
                        </div>
                        <div class="flex-grow-1 ms-3">
                          <h6 class="mb-0">Total Items</h6>
                          <h4 class="mb-0 mt-2">1,250</h4>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-md-6 col-lg-3">
                  <div class="card">
                    <div class="card-body">
                      <div class="d-flex align-items-center">
                        <div class="flex-shrink-0">
                          <div class="bg-success-subtle rounded p-3">
                            <iconify-icon icon="solar:warehouse-line-duotone" class="fs-3 text-success"></iconify-icon>
                          </div>
                        </div>
                        <div class="flex-grow-1 ms-3">
                          <h6 class="mb-0">Warehouses</h6>
                          <h4 class="mb-0 mt-2">12</h4>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-md-6 col-lg-3">
                  <div class="card">
                    <div class="card-body">
                      <div class="d-flex align-items-center">
                        <div class="flex-shrink-0">
                          <div class="bg-info-subtle rounded p-3">
                            <iconify-icon icon="solar:folder-line-duotone" class="fs-3 text-info"></iconify-icon>
                          </div>
                        </div>
                        <div class="flex-grow-1 ms-3">
                          <h6 class="mb-0">Zones</h6>
                          <h4 class="mb-0 mt-2">45</h4>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-md-6 col-lg-3">
                  <div class="card">
                    <div class="card-body">
                      <div class="d-flex align-items-center">
                        <div class="flex-shrink-0">
                          <div class="bg-warning-subtle rounded p-3">
                            <iconify-icon icon="solar:user-line-duotone" class="fs-3 text-warning"></iconify-icon>
                          </div>
                        </div>
                        <div class="flex-grow-1 ms-3">
                          <h6 class="mb-0">Users</h6>
                          <h4 class="mb-0 mt-2">38</h4>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="row mt-4">
                <div class="col-md-12">
                  <div class="card">
                    <div class="card-body">
                      <h5 class="card-title fw-semibold mb-4">Generate Report</h5>
                      <form>
                        <div class="row">
                          <div class="col-md-4 mb-3">
                            <label for="reportType" class="form-label">Report Type</label>
                            <select class="form-select" id="reportType">
                              <option>Select Report Type</option>
                              <option>Inventory Report</option>
                              <option>Stock Movement</option>
                              <option>Item Analysis</option>
                              <option>Warehouse Summary</option>
                              <option>User Activity</option>
                            </select>
                          </div>
                          <div class="col-md-4 mb-3">
                            <label for="reportDateFrom" class="form-label">Date From</label>
                            <input type="date" class="form-control" id="reportDateFrom">
                          </div>
                          <div class="col-md-4 mb-3">
                            <label for="reportDateTo" class="form-label">Date To</label>
                            <input type="date" class="form-control" id="reportDateTo">
                          </div>
                        </div>
                        <div class="mb-3">
                          <label for="reportWarehouse" class="form-label">Warehouse (Optional)</label>
                          <select class="form-select" id="reportWarehouse">
                            <option>All Warehouses</option>
                            <option>Main Warehouse</option>
                            <option>Secondary Warehouse</option>
                            <option>Storage Warehouse</option>
                          </select>
                        </div>
                        <div class="mb-3">
                          <label for="exportFormat" class="form-label">Export Format</label>
                          <select class="form-select" id="exportFormat">
                            <option value="pdf">PDF</option>
                            <option value="csv">CSV</option>
                            <option value="xlsx">Excel (.xlsx)</option>
                          </select>
                        </div>
                        <button type="submit" class="btn btn-primary">Generate Report</button>
                        <button type="button" class="btn btn-success" id="exportReportBtn">Export Report</button>
                      </form>
                    </div>
                  </div>
                </div>
              </div>
            </div>




@section Scripts {
    <script>
        $(document).ready(function() { 
          $('#exportReportBtn').on('click', function() {
            var reportType = $('#reportType').val();
            var dateFrom = $('#reportDateFrom').val();
            var dateTo = $('#reportDateTo').val();
            var warehouse = $('#reportWarehouse').val();
            var format = $('#exportFormat').val();

            if (!reportType || reportType === 'Select Report Type') {
              alert('Please select a report type');
              return;
            }
             
            var filename = 'warehouse_report_' + new Date().toISOString().split('T')[0];
             
            var reportData = {
              type: reportType,
              dateFrom: dateFrom,
              dateTo: dateTo,
              warehouse: warehouse,
              format: format
            };
             
            if (format === 'csv') {
              exportToCSV(reportData, filename);
            } else if (format === 'xlsx') {
              exportToExcel(reportData, filename);
            } else {
              exportToPDF(reportData, filename);
            }
          });
           
          function exportToCSV(data, filename) {
            var csvContent = 'Report Type,Date From,Date To,Warehouse\n';
            csvContent += data.type + ',' + (data.dateFrom || 'N/A') + ',' + (data.dateTo || 'N/A') + ',' + (data.warehouse || 'All') + '\n';
            csvContent += '\nProduct,Quantity,Status,Warehouse\n';
            csvContent += 'Product A,150,In Stock,Main Warehouse\n';
            csvContent += 'Product B,85,In Stock,Secondary Warehouse\n';
            csvContent += 'Product C,15,Low Stock,Main Warehouse\n';

            var blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            var link = document.createElement('a');
            var url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', filename + '.csv');
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
          }
           
          function exportToExcel(data, filename) {
            var csvContent = 'Report Type,Date From,Date To,Warehouse\n';
            csvContent += data.type + ',' + (data.dateFrom || 'N/A') + ',' + (data.dateTo || 'N/A') + ',' + (data.warehouse || 'All') + '\n';
            csvContent += '\nProduct,Quantity,Status,Warehouse\n';
            csvContent += 'Product A,150,In Stock,Main Warehouse\n';
            csvContent += 'Product B,85,In Stock,Secondary Warehouse\n';
            csvContent += 'Product C,15,Low Stock,Main Warehouse\n';

            var blob = new Blob([csvContent], { type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' });
            var link = document.createElement('a');
            var url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', filename + '.xlsx');
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
          }
           
          function exportToPDF(data, filename) {
            var printWindow = window.open('', '_blank');
            printWindow.document.write('<html><head><title>' + filename + '</title>');
            printWindow.document.write('<style>body{font-family:Arial;padding:20px;}table{border-collapse:collapse;width:100%;}th,td{border:1px solid #ddd;padding:8px;text-align:left;}th{background-color:#f2f2f2;}</style>');
            printWindow.document.write('</head><body>');
            printWindow.document.write('<h2>Warehouse Report</h2>');
            printWindow.document.write('<p><strong>Report Type:</strong> ' + data.type + '</p>');
            printWindow.document.write('<p><strong>Date From:</strong> ' + (data.dateFrom || 'N/A') + '</p>');
            printWindow.document.write('<p><strong>Date To:</strong> ' + (data.dateTo || 'N/A') + '</p>');
            printWindow.document.write('<p><strong>Warehouse:</strong> ' + (data.warehouse || 'All') + '</p>');
            printWindow.document.write('<table>');
            printWindow.document.write('<tr><th>Product</th><th>Quantity</th><th>Status</th><th>Warehouse</th></tr>');
            printWindow.document.write('<tr><td>Product A</td><td>150</td><td>In Stock</td><td>Main Warehouse</td></tr>');
            printWindow.document.write('<tr><td>Product B</td><td>85</td><td>In Stock</td><td>Secondary Warehouse</td></tr>');
            printWindow.document.write('<tr><td>Product C</td><td>15</td><td>Low Stock</td><td>Main Warehouse</td></tr>');
            printWindow.document.write('</table>');
            printWindow.document.write('</body></html>');
            printWindow.document.close();
            printWindow.print();
          }
        });
    </script>
}